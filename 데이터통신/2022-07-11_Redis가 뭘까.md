# Redis가 뭘까?

## 목적

Redis가 뭐하는 용도로 쓰는 기술인지, 넓은 범위에서 알아보고 키워드를 정리해본다.

## Redis 특성

```
- 영속성 : 프로세스가 종료되더라도 데이터 유실 X, 공식문서에서는 RDB와 AOF를 혼용해서 사용할 것을 권장한다. 주기적으로 스냅샷을 뜨고, 다음 스냅샷 주기가 오기전까진 로그파일에다가 변경사항들을 저장하는 것이다.
  - Snapshot(RDB) : 메모리를 통째로 디스크에 옮겨 저장하는 방식
  - AOF : 모든 연산 내용을 로그파일로 기록하는 방식
- 인메모리 데이터 저장소
- 다양한 자료구조
- 서버측 리플리케이션
- 클라이언트측 샤딩 지원
- 싱글 스레드 방식 => 원자적 연산처리 => Race Condition 거의 발생 X
```

## 서비스에서 캐시 서버를 채택하는 이유?

1. DB 쿼리방식의 경우 매번 디스크에 접근하여 데이터를 꺼내 읽어야 하는 특성이 존재한다. 중소규모의 서비스의 경우에는 이러한 디스크 접근 특성이 부담되지 않을 수 있으나, 서비스의 규모가 커져감으로써 발생하는 트래픽은 서비스의 성능 저하를 불러올 수 있다. 이러한 이슈 해결을 위해서 자주 조회되고 갱신은 적게 이루어지는 데이터들은 디스크단에서 메모리단으로 옮겨와서 캐시 형태로 관리하고 때문에 서비스 처리 속도를 높일 수가 있다.
2. 서비스의 확장으로 WAS가 증설되게 되면 로드벨런싱이 이루어지고 특정 유저가 어느 서버로 리소스를 요청할지 확정하기가 어렵다. 이런 이유 때문에 로그인 세션도 역시 특정 WAS에 둘 수가 없는 상황이다. 그래서 모든 WAS가 하나의 서버에서 세션 메모리를 이용할 수 있도록 캐시 서버를 사용한다.

## 캐시 서버 패턴

```
- Look aside cache (읽기 전용)
  1. 캐시에 데이터 존재 유무 확인.
  2. 데이터가 있다면 캐시 데이터 사용.
  3. 데이터가 없으면 DB에 접근해서 데이터 사용.
  4. DB에서 가져온 데이터를 캐시로 저장.
- Write Back (쓰기 전용)
  1. 웹서버는 요청 받은 리소스를 모두 캐시에 저장.
  2. 캐시에 일정 시간동안 데이터를 저장.
  3. 캐시에 있는 데이터를 DB에 저장.
  4. DB에 저장한 캐시 데이터 삭제.
```


## Redis Architecture

```
- Redis Replication
- Redis Cluster
- Redis Sentinel
- Redis Topology
- Redis Shading
- Redis Failover
```

## References

- https://steady-coding.tistory.com/586
- https://engkimbs.tistory.com/869